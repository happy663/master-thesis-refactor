

\section{要求仕様}

屋内環境における位置推定システムの開発には，環境条件と利用可能な補正情報の多様性を考慮する必要がある．
本節では，様々な環境や状況に適応可能なPDRベースの3次元屋内位置推定ライブラリを構築するための要求仕様について述べる．


\subsection{補正情報の分類と優先度}

位置推定の補正に利用可能な情報は，その特性と入手可能性から2つに分類できる．
まず基本となるのはセンサ情報であり，これはスマートフォンなどの端末に搭載されたセンサから得られる情報である．
加速度センサとジャイロセンサはPDRの基本処理に必須であり，気圧センサは階層判定による3次元位置推定を可能にする重要な情報源となる．
これらのセンサ情報は，端末が利用可能である限り常に取得できる特徴がある．

次に重要なのが環境情報である．
これは屋内空間の物理的な構造や設置されている機器から
得られる情報を包括的に指す．フロアマップはもっとも代表的な環境情報であり，多くの
施設で比較的容易に入手可能である．フロアマップは歩行可能な領域の制約として機能し，
PDRの累積誤差を抑制する有効な手段となる．
また，Wi-FiアクセスポイントやBLEビーコン
からの電波強度情報も重要な環境情報である．
Wi-Fiは多くの施設にすでに整備されており，追加のインフラ設置なしで位置推定に活用できる利点がある．
一方，BLEビーコンは必要に応じて追加設置が可能であり，位置推定の補正により細かな調整が可能である．

本ライブラリの開発にあたり，
磁気センサやカメラなど他の情報源の活用も検討したが，現段階では採用しない．
磁気センサによる位置推定は，建物内の磁場が環境変化の影響を受けやすく，安定した補正情報として扱うのが難しい．
またカメラを用いた視覚的な位置推定は高い精度が期待できるものの，プライバシーへの配慮が必要となり，汎用的なライブラリとしての採用には課題がある．
これらの技術は将来的な拡張可能性として考慮しつつ，現時点では基本的なセンサ情報と環境情報に焦点を当てた設計とする．

\subsection{システム要件}

将来的なセンサ情報や環境情報の追加，新たな補正アルゴリズムを容易に
組み込める拡張性も重要である．
本システムでは電波強度による測位補正や，気圧センサによる階層判定などを要件としているが
今後も磁気センサによるフィンガープリントなど，様々なセンサ情報や手法の追加が想定される．
そのため，新たなセンサ情報や補正アルゴリズムを追加する際に，
既存のシステムに大きな変更を加えず実装可能な設計が重要となる．
さらに，システムの可用性と柔軟性も重要な要件となる．
特定の補正情報が利用できない状況でも，基本的なPDR処理は
可能な機能する設計とする．また，複数の補正情報が利用可能な場合は，
それらを統合して精度向上を図る機能を提供する必要がある．



% TODO:ストーリーが破綻しているので絶対修正案件:要修正
\subsection{設計方針}
これらの要件を満たすため，以下のような設計方針を採用する．
まず，階層的な補正処理を基本とする．PDRによる基本的な位置推定をベースとし，利用可能な補正情報に応じて段階的に精度を向上させる設計とする．
これにより，環境条件の変化に柔軟に対応できる．
また，標準化されたインターフェースの採用も重要である．各補正モジュールは統一されたインターフェースを通じて連携し，
新たな補正処理の追加や既存処理の組み合わせを容易にする．
また，3次元位置推定のための機能拡張も同様のインターフェースで実現できるようにする．
最後に，設定の柔軟性を確保する．
補正処理のパラメータや補正情報の組み合わせを実行時に設定可能とする．
これにより，個々の環境に最適化された位置推定システムの構築を支援する．

