\chapter{おわりに}
\thispagestyle{myheadings}


\section{まとめ}
% TODO: 構築を行ったでいいのか？

% 本論文では，様々な環境や状況に対応できるPDRベースの3次元屋内位置推定ライブラリの構築を行った．% 
PDRはスマートフォンなどの機器さえあれば環境に左右されず一定の推定が可能な推定手法である．
一方でPDRは相対的な手法であるため初期位置，初期進行方向が不明な問題や
時間の経過に応じて特有の誤差が蓄積する問題がある．
そのため環境情報などを使用して補正するハイブリット手法が用いられる場合が多い．
しかしハイブリット手法は特定の環境を想定したものが多く，複数の環境での適用は難しい．
そこで本研究では様々な環境や状況に対応できる
PDRベースの3次元屋内位置推定ライブラリの検討と構築を行った．

具体的にはPDRアルゴリズムの包括的実装を行った.
PDRの各要素（ステップ検出，方向推定，軌跡計算）を柔軟に設計し，
モジュラーな構造を実現した．TrajectoryCalculatorとPDREstimatorの設計により，
異なるセンサー設定や環境に適応可能なアルゴリズムを構築した．
DriftCorrector，MapMatchCorrector，WirelessSignalCorrectorなどの補正モジュールを開発し，
軌跡補正手法の多様化を行った．
また気圧センサーデータを活用したFloorIdentifierにより，
2次元軌跡に階層情報を付加し，3次元的な位置推定を可能にした．

ライブラリのアルゴリズム構築やその検証のために
xDR Challenge2023の環境を用いた．
実際の歩行時のトレーニングデータを用いた各処理の流れやそのコード，
推定軌跡の可視化を行い，軌跡がどのようにして補正されるかを示した．
評価の結果としてl\_ce,l\_eag,l\_ve,l\_obstacleの項目において
一定の精度を達成できた．しかし局所空間における円形誤差(l\_ca)は
著しく低い結果となった．この理由として実装アルゴリズムが
比較的シンプルな構成であり，様々な環境変化への対応力が限定的であるのが挙げられる．

% 何かかかないといけないが上手くかけないのでコメントアウト
% また他環境での適用可能性について駅構内と大学キャンパスでの検討を行った．
% 駅構内での改札の位置を用いたドリフト除去フロアマップを用いた初期進行方向補正性の適用可能性を示した．


% \section{今後の課題}
% 課題としてはPDRアルゴリズムの改善が挙げられる．
% 歩幅や歩行タイミングの精度の向上によって位置推定の精度向上が期待できる．
% また本論文は２次元の屋内位置推定のみを想定したライブラリ構成となっている．
% 現実の屋内では3次元で構成されるものが多いため，本ライブラリを3次元空間に適用できるような拡張を検討したい．
% 具体的にはスマートフォンの気圧センサを使用すれば相対的な階層間の移動の検知が可能である．
% これとフロアマップ情報を組み合わせによって3次元空間での位置推定が実現できると考えられる．
%
%
% \section{今後の課題}
%
% 本研究で開発したライブラリは，様々な環境での位置推定を可能とする基盤を提供したが，
% さらなる改善と発展の余地が存在する．主要な課題は以下の3つの観点から整理される．
%
% 第一に，PDRアルゴリズムの基本性能の向上が挙げられる．
% 現状の実装では，歩幅推定に固定値や単純なモデルを採用しているが，
% これを機械学習を用いた動的な推定モデルに発展させることで，
% より正確な移動距離の推定が期待できる．
% また，方向推定においても地磁気センサとの融合やカルマンフィルタなどの状態推定手法の導入により，
% ドリフト誤差の低減が可能となる．さらに，
% マップマッチングにおいてはパーティクルフィルタを用いた確率的なアプローチの導入により，
% 壁抜けなどの物理的に不適切な軌跡の発生を効果的に抑制できる．
%
% 第二に，システム設計面での改善が必要である．現在のビルダーパターンによる設計は，
% 補正処理の柔軟な組み合わせを可能としているが，
% 処理の優先順位付けや条件分岐の制御については改善の余地がある．
% また，リアルタイムでの位置推定を実現するため，
% センサーデータの非同期処理への対応も重要な課題となる．
% さらに，大規模な施設での運用を見据え，
% データ処理の効率化やメモリ使用量の最適化も検討が必要である．
%
% 第三に，評価方法の拡充が重要である．
% xDR Challenge 2023の環境での評価に加え，
% 商業施設やオフィスビル，地下街など，異なる特性を持つ環境での検証が必要となる．
% 特に，センサーの経年劣化や環境の季節変化など，
% 長期運用時の安定性に関する評価は重要である．
% また，ライブラリのユーザビリティ向上のため，
% API設計の改善やドキュメントの充実化も課題として挙げられる．
%
% 気圧センサを用いた3次元位置推定については，
% 現状でも基本的な階層検知は実現しているが，
% エレベーターや階段での移動など，より複雑な状況への対応が必要である．
% また，気圧の環境変化に対するロバスト性の向上も重要な課題となる．
%
% これらの課題に取り組むことで，
% より実用的で信頼性の高い屋内位置推定ライブラリの実現を目指す．
% 特に，実環境での長期運用を見据えた改善は，本ライブラリの実用化において重要な意味を持つ．

\section{今後の課題}

PDRアルゴリズムの基本性能の向上は，引き続き重要な課題である．
現状の実装では，歩行タイミングの検出に適応的な閾値処理を用いているが，
歩行速度や路面状況の急激な変化に対する追従性には改善の余地がある．
また，方向推定においては地磁気センサとの融合による補正が考えられるが，
磁場の歪みが大きい環境での安定性確保が技術的な課題となる．
マップマッチングについては，現在の決定論的なアプローチに加えて，
位置の不確実性を考慮した確率的な手法の導入を検討する必要がある．
具体的にパーティクルフィルターの導入により，
センサーノイズや環境の不確実性をより適切に扱える可能性がある．

システム設計面では，処理の優先順位付けや条件分岐の制御についての改善が必要である．
現在のビルダーパターンによる設計は補正処理の柔軟な組み合わせを可能としているが，
環境条件の変化に応じた動的な処理の切り替えには対応していない．
また，リアルタイムでの位置推定を実現するため，
センサーデータの非同期処理への対応も課題となる．
さらに，大規模な施設での運用を見据え，
データ処理の効率化やメモリ使用量の最適化も検討が必要である．

% 評価方法の拡充も重要な課題である．
% xDR Challenge 2023の環境での評価に加え，
% 商業施設やオフィスビル，地下街など，異なる特性を持つ環境での検証が必要となる．
% 特に，センサーの経年劣化や環境の季節変化など，長期運用時の安定性に関する評価は重要である．
また，API設計の改善やドキュメントの充実化を通じて，
ライブラリの利用者がより容易に最適な位置推定システムを構築できる環境を整備する必要がある．
これらの課題に取り組むことで，より実用的で信頼性の高い屋内位置推定ライブラリの実現を目指す．
特に，実環境での長期運用を見据えた改善は，本ライブラリの実用化において重要な意味を持つ．



