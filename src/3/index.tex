
\chapter{PDR ベースの3次元屋内位置推定ライブラリの検討}
\thispagestyle{myheadings}
本章では，屋内位置推定ライブラリの要求仕様の検討およびその実装について述べる．
節3.1ではライブラリの要求仕様について詳述する．
節3.2では軌跡の画像と関数を用いて，どのような補正を行っているかを示す．
節3.3では気圧データを用いた3次元的な位置推定について示す．
% TODO: 2.PALKIAの名前を出してもいいかもしれない，本ライブラリの所を全てPALKIAで置き換える

\input{./3/3.1/required.tex}


\section{xDR Challenge 2023環境における平面的な位置推定}

本ライブラリの補正アルゴリズム実装の検討および，その有効性の検証においてxDR Challenge 2023\cite{xdr}の環境を用いる．
xDR Challenge 2023 はPDRベンチマーク委員会が主催する屋内位置推定の精度を競うコンテストである．
このコンテストでは主催者が参加者に対して複数の訓練データを提供する．
被験者は腰にスマートフォンをつけた状態で，LiDARと呼ばれる距離測定技術を搭載したハンドヘルドLiDARを持ちBLEビーコンが配置された高速道路のサービスエリア内を歩く．
この過程で取得されたデータが訓練データとして提供される．
LiDARからは歩行者のフロアマップにおける歩行者の初期位置，終了位置，移動経路のデータが提供される．
LiDARは光を使って物体や壁までの距離を精密に測定できる技術であり，
このコンテストではLiDARから得られる提供データを正解軌跡として扱っている．
スマートフォンからは加速度，角速度，地磁気，各BLEビーコンのAP情報と受信電波強度が提供される．
フロアマップ情報，各ビーコンのフロアマップにおける基地局の位置情報は事前にコンテスト主催者側によって提供される．
そしてこの提供されたデータを基にコンテスト参加者は独自の推定アルゴリズムの開発を行い位置推定を行う．
本番で与えられるスコアを付けるためデータは訓練データと同様のフロアマップのデータが提供されるが，
LiDARからのデータは初期位置,初期姿勢，終了位置，終了姿勢のみが提供され，それ以外の情報を使って歩行者の移動軌跡を推定する．
xDR Challenge 2023の環境は，フロアマップ情報，各ビーコンの情報，スマートフォンからのセンサデータが提供されている．
そのためPDRと他の情報を使用した補正が可能であり，本ライブラリの要求仕様に適合している．
またライブラリを用いた処理の結果どのような補正の効果が得られるのかを検証する必要がある．
xDR Challenge 2023の環境は後述する評価システムが確立されており，本ライブラリの有効性を検証する環境が整備されている．
よってこの環境を基に補正アルゴリズム実装の検討および有効性の検証を行う．

\begin{figure}[ht]
	\centering
	\includegraphics[width=\linewidth]{image/lidar.jpg}
	\caption{歩行者の装着器具}    \label{fig:step_detect}
\end{figure}


\input{./3/3.2/3.2.1/pdr.tex}


\subsection{軌跡の補正}

PDR処理で得られた軌跡には，前節で示したように2つの主要な課題がある．
これらの課題に対処するため，本ライブラリでは複数の補正手法を提供している．
各補正手法は異なるアプローチで軌跡の改善を試みるが，
これらを効果的に組み合わせることで，より高精度な位置推定が可能となる．

\input{./3/3.2/3.2.2/correct_design.tex}
\input{./3/3.2/3.2.2/remove_drift.tex}
\input{./3/3.2/3.2.2/rotate_trajectory_map.tex}
\input{./3/3.2/3.2.2/ble_position.tex}
\input{./3/3.2/3.2.2/ble_fingerprint.tex}
\input{./3/3.2/3.2.2/map_matching_unwalkble}

\section{気圧データを用いた3次元的な位置推定}

\input{./3/3.3/pressure.tex}

